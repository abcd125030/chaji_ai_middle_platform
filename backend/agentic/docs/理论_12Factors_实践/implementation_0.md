3. 工作量评估：中等规模

  核心开发工作（约16-24小时）：

  第一阶段：基础架构（4-6小时）
  - 创建chain_components模块结构
  - 设计组件间数据传递的Schema
  - 实现链式调用基础框架

  第二阶段：组件实现（8-12小时）
  - Analyzer组件：2-3小时
  - Strategist组件：2-3小时
  - Executor组件：3-4小时
  - 组件间集成：1-2小时

  第三阶段：集成改造（4-6小时）
  - 改造planner_node使用链式组件
  - 添加兼容性开关
  - 保持原有接口不变

  4. 技术难度分析

  低难度：
  - YAML模板系统已经成熟
  - PromptManager可以复用
  - 数据结构清晰

  中等难度：
  - 组件间状态传递设计
  - 保持完全向后兼容
  - 性能优化（避免过多函数调用）

  高难度：
  - 决策逻辑拆分的合理性
  - 错误处理和回滚机制
  - 充分的测试覆盖

  5. 预期收益

  - Token减少50%+：每个组件prompt仅100-200 tokens
  - 响应速度提升30%+：减少LLM处理时间
  - 维护性大幅提升：单一职责，易于定位问题
  - 灵活性增强：可为不同组件配置不同模型

  6. 风险与建议

  主要风险：
  - 链式调用可能增加延迟（多次函数调用）
  - 组件拆分不当可能降低决策质量

  实施建议：
  1. 先做POC验证：选择一个简单场景验证链式架构
  2. 渐进式重构：保留原实现，通过开关切换
  3. 充分监控：记录每个组件的耗时和token消耗
  4. A/B测试：对比新旧实现的效果

  🎯 结论

  该重构方案值得实施，预计总工作量16-24小时，可分阶段进行。建议先实现基础架构和一个简单组
  件进行验证，确认效果后再全面推进。